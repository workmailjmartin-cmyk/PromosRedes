<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feliz Viaje - Gestión</title>
    <link rel="icon" href="Favicon.ico" type="image/x-icon">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
</head>
<body>

    <div id="login-container" class="login-container">
        <div class="login-box">
            <div class="logo"><img src="logo.png" alt="Feliz Viaje" style="height: 80px; margin: 0 auto;"></div>
            <h2 style="color:#11173d;">Acceso Plataforma</h2>
            <button id="login-button" class="btn btn-primario" style="width:100%; margin-top:20px;">Iniciar con Google</button>
        </div>
    </div>

    <div id="app-container" style="display:none;">
        
        <header class="main-header">
            <div class="header-content">
                <div class="logo" title="Recargar página">
                    <img src="logo.png" alt="Logo Feliz Viaje" id="app-logo">
                </div>

                <nav class="app-nav">
                    <button class="nav-button active" id="nav-search">Buscar</button>
                    <button class="nav-button" id="nav-upload">Cargar</button>
                    <button class="nav-button" id="nav-gestion" style="display:none;">Gestión</button>
                    <button class="nav-button" id="nav-users" style="display:none;">Usuarios</button>
                </nav>

                <div class="user-info">
                    <span id="user-email">Cargando...</span>
                    
                    <button class="Btn" id="logout-button">
                        <div class="sign">
                            <svg viewBox="0 0 512 512"><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"></path></svg>
                        </div>
                        <div class="text">Salir</div>
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <div id="view-search" class="view active">
                <div class="panel-filtros" style="background:#fff; padding:20px; border-radius:12px; display:flex; gap:15px; margin-bottom:20px; box-shadow:0 2px 10px rgba(0,0,0,0.05);">
                    <input type="text" id="filtro-destino" placeholder="Buscar destino..." style="flex:1;">
                    <select id="filtro-promo"><option value="">Todas las Promos</option><option value="Solo X Hoy">Solo X Hoy</option><option value="FEED">FEED</option><option value="ADS">ADS</option></select>
                    <select id="filtro-creador" style="display:none;"><option value="">Todas las Franquicias</option></select>
                    <select id="filtro-orden"><option value="reciente">Más Recientes</option><option value="menor_precio">Menor Precio</option><option value="mayor_precio">Mayor Precio</option></select>
                    <button id="boton-buscar" class="btn btn-primario">Buscar</button>
                    <button id="boton-limpiar" class="btn btn-secundario">Limpiar</button>
                </div>
                <div id="grilla-paquetes" class="grilla-resultados"></div>
            </div>

            <div id="view-upload" class="view">
                <div class="upload-form-container">
                    <h2 style="color:#11173d;">Nuevo Paquete</h2>
                    <form id="upload-form">
                        <div class="form-group-row">
                            <div class="form-group"><label>Destino</label><input type="text" id="upload-destino" required></div>
                            <div class="form-group"><label>Salida</label><input type="text" id="upload-salida" required></div>
                        </div>
                        <div class="form-group-row">
                            <div class="form-group"><label>Fecha Salida</label><input type="date" id="upload-fecha-salida" required></div>
                            <div class="form-group"><label>Moneda</label><select id="upload-moneda"><option>USD</option><option>ARS</option></select></div>
                            <div class="form-group"><label>Tipo Promo</label><select id="upload-promo"></select></div>
                        </div>
                        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
                        <h3 style="color:#11173d;">Servicios</h3>
                        <div class="add-service-bar" style="display:flex; gap:10px; margin-bottom:15px;">
                            <select id="selector-servicio" style="flex:1;">
                                <option value="">Seleccionar Servicio...</option>
                                <option value="aereo">Aéreo</option>
                                <option value="hotel">Hotel</option>
                                <option value="traslado">Traslado</option>
                                <option value="seguro">Seguro</option>
                                <option value="bus">Paquete Bus</option>
                                <option value="crucero">Crucero</option>
                                <option value="adicional">Adicional</option>
                            </select>
                            <button type="button" id="btn-agregar-servicio" class="btn btn-secundario" style="background:#11173d; color:white;">+ Agregar</button>
                        </div>
                        <div id="servicios-container"></div>
                        <hr style="border:0; border-top:1px solid #eee; margin:20px 0;">
                        <div class="form-group"><label>Financiación / Info Extra</label><textarea id="upload-financiacion" rows="2"></textarea></div>
                        <div class="form-group-row" style="background:#f4f7f9; padding:20px; border-radius:12px; align-items:center;">
                            <div class="form-group"><label>Costo Total</label><input type="number" id="upload-costo-total" readonly style="background:#e0e0e0; font-weight:bold;"></div>
                            <div class="form-group"><label>Tarifa de Venta (Final)</label><input type="number" id="upload-tarifa-total" required style="border:2px solid #ef5a1a; font-size:1.2em; color:#ef5a1a;"></div>
                        </div>
                        <div style="text-align:right; margin-top:20px;">
                            <button type="submit" class="btn btn-primario" style="padding:15px 40px; font-size:1.1em;">Guardar Paquete</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="view-gestion" class="view">
                <h2 style="color:#11173d;">Paquetes Pendientes de Aprobación</h2>
                <div id="grid-gestion" class="grilla-resultados"></div>
            </div>

            <div id="view-users" class="view">
                <div class="upload-form-container">
                    <h2>Gestión de Usuarios</h2>
                    <form id="user-form" style="margin-bottom:30px; display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end;">
                        <div class="form-group" style="flex:2;"><label>Email</label><input type="email" id="user-email-input" required></div>
                        <div class="form-group"><label>Rol</label><select id="user-role-input"><option value="usuario">Usuario</option><option value="editor">Editor</option><option value="admin">Admin</option></select></div>
                        <div class="form-group" style="flex:2;"><label>Franquicia/Alias</label><input type="text" id="user-franchise-input" required></div>
                        <button type="submit" class="btn btn-primario" style="margin-bottom:2px;">Guardar</button>
                    </form>
                    <ul id="users-list" style="list-style:none; padding:0;"></ul>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-detalle" class="modal-overlay" style="display: none;">
        <div class="modal-contenido">
            <button id="modal-cerrar" class="modal-cerrar-btn">×</button>
            <div id="modal-body" class="modal-detalle-body">
                </div>
        </div>
    </div>

    <div id="custom-alert-overlay" class="custom-alert-overlay" style="display: none;">
        <div class="custom-alert-box">
            <div id="custom-alert-icon" style="font-size:3em; margin-bottom:15px;"></div>
            <h3 id="custom-alert-title" style="margin:0 0 10px 0; color:#11173d;"></h3>
            <p id="custom-alert-message" style="color:#555; margin-bottom:25px;"></p>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button id="custom-alert-cancel" class="btn btn-secundario" style="display:none;">Cancelar</button>
                <button id="custom-alert-btn" class="btn btn-primario">Aceptar</button>
            </div>
        </div>
    </div>

    <div id="loader-overlay">
        <div class="hourglassBackground">
            <div class="hourglassContainer">
                <div class="hourglassCurves"></div>
                <div class="hourglassCapTop"></div>
                <div class="hourglassGlassTop"></div>
                <div class="hourglassSand"></div>
                <div class="hourglassSandStream"></div>
                <div class="hourglassCapBottom"></div>
                <div class="hourglassGlass"></div>
            </div>
        </div>
        <p style="margin-top:20px; font-weight:600; color:#11173d; font-size:1.2em;">Procesando...</p>
    </div>

    <script src="app.js"></script>
</body>
</html>
